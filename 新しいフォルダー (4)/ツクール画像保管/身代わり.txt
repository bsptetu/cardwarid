BattleManager.applySubstitute = function(target) {
    if (this.checkSubstitute(target)) {
        var substitute = target.friendsUnit().substituteBattler();
        if (substitute && target !== substitute) {
            substitute.startAnimation(129);
            this._logWindow.displaySubstitute(substitute, target);
            return substitute;
        }
    }
    return target;
};

Game_BattlerBase.prototype.isDying = function() {
    return this.isAlive() && this._hp < this.mhp / 2;
};